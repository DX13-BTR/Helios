---
title: Inject AI Advice into Helios FSS Dashboard
tags: [fss, dashboard, html, apps-script, gpt-advice]
created: 2025-07-16
---

# ðŸ’¬ Inject GPT Advice into Helios FSS Dashboard

This module adds a section to your HTML dashboard that displays the most recent GPT-powered financial advice generated by `generateAIAdvice()`.

---

## ðŸ§± 1. Update `doGet()` in Apps Script

Replace your existing `doGet()` function with this:

```javascript
function doGet() {
  const ss = SpreadsheetApp.getActiveSpreadsheet();
  const dashboard = ss.getSheetByName('HeliosDashboard');
  const adviceSheet = ss.getSheetByName('AdviceOutput');

  // Get metrics
  const metrics = dashboard.getRange('B2:B13').getValues().flat();

  // Get latest advice (last non-empty row from column B)
  const adviceRows = adviceSheet.getDataRange().getValues();
  const lastRow = adviceRows.reverse().find(row => row[1] && row[1].toString().trim().length > 0);
  const adviceText = lastRow ? lastRow[1] : "No advice available.";

  // Prepare HTML
  const template = HtmlService.createTemplateFromFile('index');
  template.metrics = metrics;
  template.adviceText = adviceText;

  return template.evaluate()
    .addMetaTag('viewport', 'width=device-width, initial-scale=1')
    .setTitle('Helios FSS Dashboard');
}
```

---

## ðŸ–¼ 2. Update your `index.html` dashboard template

Somewhere below your current grid (e.g. after the buffer section), insert this:

```html
<section class="advice-section" style="margin-top: 2em; padding: 1em; border-top: 2px solid #c7ae6a;">
  <h2 style="color: #625772;">ðŸ’¡ Weekly AI Spending Advice</h2>
  <div style="white-space: pre-wrap; font-family: sans-serif; background: #f9f5ff; padding: 1em; border-radius: 8px;">
    <?= adviceText ?>
  </div>
</section>
```

---

## âœ… Outcome

You will now see the most recent GPT-generated spending advice directly on the dashboard, formatted cleanly and pulled live from your `AdviceOutput` sheet.

---

## ðŸ›  Optional Enhancements

- Add a timestamp: `<?= new Date().toLocaleDateString() ?>`
- Make collapsible with `<details>`/`<summary>` for lighter UI
- Include buttons for "regenerate advice" or future export

---
